# 크리스마스 프로모션
[기능 요구명세서](./기능-요구명세서.md)<br>
[작업 기록](todo.md)

# 이벤트 플래너 기능 개요

- `12월 이벤트 플래너`는 12월 식당 할인 행사에 쓰일 기능입니다. 
- 사용자가 방문날짜와 메뉴를 입력하면 조건에 맞는 할인유형과 금액을 보여주며, 할인받은 정도를 뱃지로 구분하여 다음 행사 참여를 유도하도록 하는 기능들을 담고 있습니다. 

# 기능 세부사항

1. 날짜 입력받고 검증
2. 주문 입력받아서 검증 후 주문정보 저장
3. 주문 메뉴 출력, 총 주문 금액 계산하여 출력
4. 총 지불금액으로 혜택을 받는 대상인지 확인 후 혜택정보 저장
5. 사용자가 받을 혜택 금액을 각각 계산
6. 총 주문금액에 따라 증정여부 판단 후 증정혜택 출력
7. 사용자가 받을 총 혜택 금액을 계산
8. 각각 해당하는 혜택을 출력,총 할인가 및 예상 결제금액 출력
9. 뱃지 등급 출력
![](flowchart/ver4.png)

# 패키지와 클래스 구성
```
📁 main/java/christmas
	ㄴ📁controller
	ㄴ📁model
	ㄴ📁validator
	ㄴ📁view
```
MVC 패턴으로 구현하였으며, 입력값을 검증하는 validator 패키지를 따로 구분하였습니다.
## 1. model
```
ㄴ📁model
	ㄴ☕ Badges     // 뱃지의 정보를 Enum으로 저장
	ㄴ☕ Benefits   // 사용자의 혜택정보를 Enum으로 저장
	ㄴ☕ Menus      // 메뉴 상수를 Enum으로 저장
	ㄴ☕ Orders     // 사용자가 주문한 목록을 일급객체로 저장
	ㄴ☕ Prices     // 사용자의 주문금액과 할인금액을 저장
```

## 2. view
```
ㄴ📁view
	ㄴ☕ Input     // 값을 입력받는 클래스
	ㄴ☕ Output    // 출력 로직을 모아놓은 클래스
```

## 3. validator
```
ㄴ📁validator
	ㄴ📁menu                //📁 메뉴를 입력받고 검증하는 패키지
		ㄴ☕ CountValidator     // 메뉴 개별 갯수를 검증
		ㄴ☕ Format             // 메뉴 - 갯수의 형식인지를 검증
		ㄴ☕ MenuValidator      // 메뉴가 중복되는지, 메뉴판에 있는지를 검증
		ㄴ☕ OnlyBeverage       // 음료만 시켰는지를 검증
	ㄴ☕ Common                 // 날짜와 메뉴 검증에 공통적으로 사용되는 검증
	ㄴ☕ Day                    // 날짜 검증
	ㄴ☕ Errors                 // 에러 문구들 모아놓은 Enum 
	ㄴ☕ RaiseExceptions        // 예외처리 로직을 모아놓은 클래스
```

## 4. controller
```
ㄴ📁controller
	ㄴ📁calculate       //📁 할인사항을 계산하는 패키지
		ㄴ☕ Discount       // 지불할 금액과 날짜를 고려해 할인목록과 금액을 계산
		ㄴ☕ Pay            // 입력받은 메뉴의 값을 불러와 지불금액을 계산함
		ㄴ☕ SalePrice      // 앞서 계산한 혜택들을 이용해 뱃지와 최종 지불금액 계산
	ㄴ📁Preprocess        //📁 데이터 전처리를 하는 패키지
		ㄴ☕ API            // model에서 값들을 사용하기 좋은 형태로 가져옴    
		ㄴ☕ Preprocess     // 입력받은 메뉴 문자열을 사용하기 좋게 다듬음
	ㄴ☕ Request            // 값을 입력받을 때 사용
	ㄴ☕ Reserve            // model에 값을 저장할 때 사용
```

# 예외처리

```
<주문 예외>
"해산물파스타-2,레드와인-1,초코케이크",  
"해산물파스타-2,레드와인-1,초코케이크-1-1",  
"해산물파스타-a",  
"레드와인-1",  
"해산물파스타-21",  
"해산물파스타-2,해산물파스타-1",
"",
"제로콜라-a"
```


# 기능구현 진척
### ✅ 1. 날짜 입력받아 혜택 구분하기

- [x] 날짜 입력받기
	- [x] 날짜 검증로직
		- [x] 1 ~ 31
		- [x] 정수형인지
- [x] 날짜 혜택 구분하고 
- [x] 혜택정보 Benefit에 저장

### ✅ 2. 주문 입력받아서 주문정보 저장


- [x] 메뉴 입력받기
	- [x] 주문검증로직1
		- [x] 메뉴에 없다면
			- [x] Menu를 가져와서 순회하며 비교
		- [x] 갯수가 1개 이상이어야
		- [x] 형식이 이상할 때
		- [x] 중복될때
	- [x] 주문검증로직2
		- [x] 주문한 갯수가 20개 이상일때
		- [x] only 음료만 주문했을 때
- [x] 모든 검증을 마치면 Orders에 정보를 저장
	- [x] 이름 / 갯수 정보를 저장해야됨
- [x] 주문정보 검증 리팩토링해야됨

### ✅ 3-1. 주문 메뉴 출력, 총 주문 금액 계산하여 출력

- [x] 주문 정보를 Orders에서 가져오기
- [x] 메뉴판 정보를 Menu에서 가져오기
- [x] 주문정보와 메뉴를 비교하며
	- [x] 해당하는 금액을 개별출력하고
	- [x] 누적 금액 계산해서 
		- [x] Price에 저장
		- [x] 출력

### ✅ 3-2. 총 주문금액에 따라 증정여부 판단 후 혜택 출력

- [x] 혜택 정보를 Benefit에서 가져오기
- [x] 총 금액이 10,000원 이상이면 GIFT 에 true 넣고
- [x] <증정 메뉴> 출력 (GIFT enum 의 benefit)
	- [x] true면 "샴페인 1개" 출력
	- [x] false면 "없음" 출력

### ✅ 4. 사용자가 받을 혜택 금액을 각각 계산

- [x] 주문 정보를 Orders에서 가져오기
- [x] 메뉴판 정보를 Menus에서 가져오기
- [x] 혜택 정보를 Benefit에서 가져오기
- [x] Benefit을 순회하면서 true인 혜택에 대해서 
	- [x] end 
		- [x] Orders 순회하면서
			- [x] Menu랑 비교해서 
			- [x] type이 main인 ruddnaks cnt x 2023 누적
			- [x] Benefit에 저장
	- [x] day
		- [x] Orders 순회하면서
			- [x] Menu랑 비교해서 
			- [x] type이 dessert인 ruddnaks cnt x 2023 누적
			- [x] Benefit에 저장 
	- [x] star
		- [x] return -1000
		- [x] Benefit에 저장
	- [x] dday
		- [x] return -1x(1000+(day-1)x100)
		- [x] Benefit에 저장
	- [x] gift
		- [x] return -25000
	- [x] 혜택이 전부 false - 없음 출력 (누적으로 기록하기)
	- [x] 조건이 약간 이상함 이거 고쳐야돼 => 주중/주말을 서로 바꿔서 계산하고 있었음 ...

### ✅ 5. 사용자가 받을 총 혜택 금액을 계산

- [x] Benefit에서 혜택 값을 가져오기
- [x] true인 benefit의 price를 누적해서
- [x] Prices에 저장하기

### ✅ 6. 혜택 출력, 총 할인가 및 예상 결제금액 출력

- [x] Prices에서 개별할인가 출력
- [x] 총 할인가 출력
- [x] 예상결제금액 출력

### ✅ 7. 뱃지 등급 출력

- [x] Prices에서 총 할인가 가져오고
- [x] Badges에서 뱃지 정보 가져와서 
- [x] 값을 비교하며 범위에 해당하는 뱃지 이름 출력
